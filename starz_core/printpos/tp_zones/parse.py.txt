# starz_core/printpos/tp_zones/parse.py
from __future__ import annotations

import re
from typing import Tuple

_COORD_RE = re.compile(r"-?\d+(\.\d+)?")


def parse_xyz(s: str) -> Tuple[float, float, float]:
    """
    Accepts:
      "1,2,3"
      "1 2 3"
      "(1, 2, 3)"
      "x=1 y=2 z=3" (as long as numbers exist)
    """
    nums = _COORD_RE.findall(s)
    # findall returns only captured groups if groups exist; use finditer instead
    vals = [m.group(0) for m in re.finditer(_COORD_RE, s)]
    if len(vals) < 3:
        raise ValueError(f"Invalid coord string: {s!r}")

    x = float(vals[0])
    y = float(vals[1])
    z = float(vals[2])
    return (x, y, z)
